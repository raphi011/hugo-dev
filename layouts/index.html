{{ define "main" }}
  {{ with .Content }}<div class="prose max-w-none mb-8">{{ . }}</div>{{ end }}

  {{/* Writing section — section name and post count are configurable via site params */}}
  {{ $writingSection := .Site.Params.writingSection | default "writing" }}
  {{ $postCount := .Site.Params.homepagePostCount | default 5 }}
  {{ $writing := where .Site.RegularPages "Section" $writingSection }}
  {{ with $writing }}
    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-4">
        <a href="{{ printf "%s/" $writingSection | relURL }}" class="text-ctp-text hover:text-ctp-blue transition-colors">
          {{ i18n "writing_heading" | default "Writing" }}
        </a>
      </h2>
      <div class="space-y-4">
        {{ range first $postCount . }}
          <article>
            <a href="{{ .RelPermalink }}" class="text-ctp-blue hover:text-ctp-sky transition-colors">
              {{ .Title }}
            </a>
            {{ if not .Date.IsZero }}
              <p class="text-sm text-ctp-subtext0">
                <time datetime="{{ .Date.Format "2006-01-02" }}">
                  {{ .Date.Format "Jan 2, 2006" }}
                </time>
              </p>
            {{ end }}
          </article>
        {{ end }}
      </div>
      {{ if gt (len .) $postCount }}
        <p class="mt-4">
          <a href="{{ printf "%s/" $writingSection | relURL }}" class="text-sm text-ctp-blue hover:text-ctp-sky transition-colors">
            {{ i18n "view_all_writing" | default "All posts" }} &rarr;
          </a>
        </p>
      {{ end }}
    </section>
  {{ end }}

  {{/* Projects section — section name is configurable via site params */}}
  {{ $projectsSection := .Site.Params.projectsSection | default "projects" }}
  {{ $projects := where .Site.RegularPages "Section" $projectsSection }}
  {{ with $projects }}
    <section>
      <h2 class="text-xl font-semibold mb-4">
        <a href="{{ printf "%s/" $projectsSection | relURL }}" class="text-ctp-text hover:text-ctp-blue transition-colors">
          {{ i18n "projects_heading" | default "Projects" }}
        </a>
      </h2>
      <div class="space-y-4">
        {{ range sort . "Params.weight" }}
          {{ partial "project-card.html" (dict "project" . "compact" true) }}
        {{ end }}
      </div>
    </section>
  {{ end }}
{{ end }}
